<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MyMoney.App.Views.BudgetPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MyMoney.App.Views"
    xmlns:lvc="using:LiveChartsCore.SkiaSharpView.WinUI"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:viewmodels="using:MyMoney.App.ViewModels" d:DataContext="{d:DesignInstance Type=viewmodels:BudgetViewModel}"
    mc:Ignorable="d">

    <Grid Margin="36,0,36,0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*"/>
            <ColumnDefinition Width="3*"/>
            <ColumnDefinition Width="1*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="1*"/>
        </Grid.RowDefinitions>

        <TextBlock Margin="0,36,0,36" Grid.Row="0" Grid.ColumnSpan="3" Text="Budget" Style="{StaticResource TitleTextBlockStyle}"/>


        <Border CornerRadius="4" Grid.Column="0" Grid.Row="1" VerticalAlignment="Top" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
            <StackPanel Margin="16">
                <TextBlock Style="{StaticResource SubtitleTextBlockStyle}" Margin="0,0,0,24">Budgets</TextBlock>
                <TextBlock FontWeight="SemiBold" Margin="0,0,0,8">Current Budget</TextBlock>
                <ListView ItemsSource="{Binding CurrentBudgets}" SelectedIndex="{Binding CurrentBudgetsSelectedIndex}" Margin="0,0,0,20">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding BudgetTitle}" Margin="0,2,0,2"/>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
                <TextBlock FontWeight="SemiBold" Margin="0,0,0,8">Future Budgets</TextBlock>
                <ListView ItemsSource="{Binding FutureBudgets}" SelectedIndex="{Binding FutureBudgetsSelectedIndex}" Margin="0,0,0,20">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding BudgetTitle}" Margin="0,2,0,2"/>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
                <TextBlock FontWeight="SemiBold" Margin="0,0,0,8">Older Budgets</TextBlock>
                <ListView ItemsSource="{Binding OldBudgets}" SelectedIndex="{Binding OldBudgetsSelectedIndex}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding BudgetTitle}" Margin="0,2,0,2"/>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>

        </Border>

        <StackPanel Grid.Column="1" Grid.Row="1" Margin="24,0,24,24">

            <Border CornerRadius="4" Margin="0,0,0,24" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                <Grid Margin="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Style="{StaticResource TitleTextBlockStyle}" Text="{Binding CurrentBudget.BudgetTitle}"/>
                    <Button Click="NewBudget_Clicked" Grid.Column="1" Style="{ThemeResource AccentButtonStyle}" Margin="12,0,0,0">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <FontIcon Glyph="&#xECC8;" Margin="0,0,4,0" VerticalAlignment="Center" />
                            <TextBlock Margin="4,0,0,0" VerticalAlignment="Center">New Budget</TextBlock>
                        </StackPanel>
                    </Button>
                </Grid>
            </Border>

            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                <TextBlock Style="{StaticResource SubtitleTextBlockStyle}">Income</TextBlock>
                <Button Margin="8,0,0,0" Command="{Binding AddIncomeItemCommand}" IsEnabled="{Binding IsEditingEnabled}" VerticalAlignment="Stretch">
                    <FontIcon Glyph="&#xE710;" FontSize="12" VerticalAlignment="Center"/>
                </Button>
            </StackPanel>


            <Border CornerRadius="4" Margin="0,4,0,8" Background="{ThemeResource CardBackgroundFillColorDefault}" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                <ListView ItemsSource="{Binding CurrentBudget.BudgetIncomeItems}" SelectedIndex="{Binding IncomeItemsSelectedIndex}" Margin="16">
                    <ListView.ContextFlyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Edit" Command="{Binding EditIncomeItemCommand}"/>
                            <MenuFlyoutItem Text="Delete" Command="{Binding DeleteIncomeItemCommand}"/>
                        </MenuFlyout>
                    </ListView.ContextFlyout>

                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="{Binding Category}" Grid.Column="0" Margin="5,5,0,5"/>
                                <TextBlock Text="{Binding Amount}" Grid.Column="1" Margin="0,5,5,5"/>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Border>

            <Border CornerRadius="4" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Margin="0,8,0,8" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                <Grid Margin="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock FontWeight="SemiBold">Total</TextBlock>
                    <TextBlock FontWeight="SemiBold" Text="{Binding IncomeTotal}" Grid.Column="1"/>
                </Grid>
            </Border>

            <StackPanel Orientation="Horizontal" Margin="0,8,0,4">
                <TextBlock Style="{StaticResource SubtitleTextBlockStyle}">Expenses</TextBlock>
                <Button Margin="8,0,0,0" Command="{Binding AddExpenseItemCommand}" IsEnabled="{Binding IsEditingEnabled}" VerticalAlignment="Stretch">
                    <FontIcon Glyph="&#xE710;" FontSize="12"/>
                </Button>
            </StackPanel>


            <Border CornerRadius="4" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Margin="0,4,0,12" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                <ListView ItemsSource="{Binding CurrentBudget.BudgetExpenseItems}" SelectedIndex="{Binding ExpenseItemsSelectedIndex}" Margin="16">
                    <ListView.ContextFlyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Edit" Command="{Binding EditExpenseItemCommand}"/>
                            <MenuFlyoutItem Text="Delete" Command="{Binding DeleteExpenseItemCommand}"/>
                        </MenuFlyout>
                    </ListView.ContextFlyout>

                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="{Binding Category}" Grid.Column="0" Margin="5,5,0,5"/>
                                <TextBlock Text="{Binding Amount}" Grid.Column="1" Margin="0,5,5,5"/>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Border>

            <Border CornerRadius="4" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" Margin="0,8,0,8" BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1">
                <Grid Margin="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock FontWeight="SemiBold">Total</TextBlock>
                    <TextBlock FontWeight="SemiBold" Text="{Binding ExpenseTotal}" Grid.Column="2"/>
                </Grid>
            </Border>

        </StackPanel>

        <Grid Grid.Column="2" Grid.Row="1" Margin="0,0,0,24">
            <Grid.RowDefinitions>
                <RowDefinition Height="1*"/>
                <RowDefinition Height="1*"/>
            </Grid.RowDefinitions>

            <!--lvc:PieChart Series="{Binding IncomePercentagesSeries}" Margin="0,0,0,12"
                          Title="{Binding IncomePercentages_Title}"/>
            <lvc:PieChart Grid.Row="1" Series="{Binding ExpensePercentagesSeries}" Margin="0,12,0,0"
                          Title="{Binding ExpensePercentages_Title}"/-->
        </Grid>
    </Grid>
</Page>
